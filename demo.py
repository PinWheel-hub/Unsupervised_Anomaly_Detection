import torch

a = torch.tensor([[[0, 0, 0], [0, 0, 0], [1, 1, 1], [1, 1, 1]], 
                    [[0, 0, 0], [0, 0, 0], [1, 1, 1], [1, 1, 1]],
                    [[2, 2, 2], [2, 2, 2], [3, 3, 3], [3, 3, 3]],
                    [[2, 2, 2], [2, 2, 2], [3, 3, 3], [3, 3, 3]]])
a = a.reshape((2, 2, 2, 2, 3))
a = a.permute((0, 2, 1, 3, 4)).reshape((4, -1))
print(a, a.shape)
print(a[1, :], a.shape)